{% extends 'admin/model/edit.html' %}

{% block access_control %}
{% if current_user.is_authenticated %}
<div class="btn-group pull-right">
    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        <i class="icon-user"></i> {{ current_user.login }} <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="{{ url_for('admin.logout') }}">Log out</a></li>
    </ul>
</div>
{% endif %}
{% endblock %}


{% block brand %}
    <style>.container {width: 96%;}</style>
    <h4 id="brand" style="width:200px"> * {{ admin_view.name|capitalize }}</h4>
{% endblock %}


{{ super() }}

{% block tail %}

    <script type="text/javascript" >
        var refresh_preview_content = function(result, status, xhr){
            document.getElementById('preview_content').innerHTML = result.responseText;
        }
        var preview_content = function() {
            var e = document.getElementById("content");
            console.log("content: " + e.text);
            var data = {'content': e.text};
            $.ajax({
                data: data,
                dataType: "json",
                success: refresh_preview_content,
                error: refresh_preview_content,
                contentType: "application/json",
                timeout: 5000,
                url: '/admin/preview_task_content',
                method: POST
            });
        }
        $(document).ready(function() {
            var e = document.getElementById("preview_content_button");
            if (e) {
                e.addEventListener("click", preview_content);
            }
        });
    </script>

{% endblock tail %}



